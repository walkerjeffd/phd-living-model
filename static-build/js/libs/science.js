(function(e){(function(e){science={version:"1.9.1"},science.ascending=function(e,t){return e-t},science.EULER=.5772156649015329,science.expm1=function(e){return e<1e-5&&e>-0.00001?e+.5*e*e:Math.exp(e)-1},science.functor=function(e){return typeof e=="function"?e:function(){return e}},science.hypot=function(e,t){e=Math.abs(e),t=Math.abs(t);var n,r;e>t?(n=e,r=t):(n=t,r=e);var i=r/n;return n*Math.sqrt(1+i*i)},science.quadratic=function(){function t(t,n,r){var i=n*n-4*t*r;return i>0?(i=Math.sqrt(i)/(2*t),e?[{r:-n-i,i:0},{r:-n+i,i:0}]:[-n-i,-n+i]):i===0?(i=-n/(2*t),e?[{r:i,i:0}]:[i]):e?(i=Math.sqrt(-i)/(2*t),[{r:-n,i:-i},{r:-n,i:i}]):[]}var e=!1;return t.complex=function(n){return arguments.length?(e=n,t):e},t},science.zeroes=function(e){var t=-1,n=[];if(arguments.length===1)while(++t<e)n[t]=0;else while(++t<e)n[t]=science.zeroes.apply(this,Array.prototype.slice.call(arguments,1));return n}})(this),function(e){function t(e,t,n){var r=n.length;for(var i=0;i<r;i++)e[i]=n[r-1][i];for(var s=r-1;s>0;s--){var o=0,u=0;for(var a=0;a<s;a++)o+=Math.abs(e[a]);if(o===0){t[s]=e[s-1];for(var i=0;i<s;i++)e[i]=n[s-1][i],n[s][i]=0,n[i][s]=0}else{for(var a=0;a<s;a++)e[a]/=o,u+=e[a]*e[a];var f=e[s-1],l=Math.sqrt(u);f>0&&(l=-l),t[s]=o*l,u-=f*l,e[s-1]=f-l;for(var i=0;i<s;i++)t[i]=0;for(var i=0;i<s;i++){f=e[i],n[i][s]=f,l=t[i]+n[i][i]*f;for(var a=i+1;a<=s-1;a++)l+=n[a][i]*e[a],t[a]+=n[a][i]*f;t[i]=l}f=0;for(var i=0;i<s;i++)t[i]/=u,f+=t[i]*e[i];var c=f/(u+u);for(var i=0;i<s;i++)t[i]-=c*e[i];for(var i=0;i<s;i++){f=e[i],l=t[i];for(var a=i;a<=s-1;a++)n[a][i]-=f*t[a]+l*e[a];e[i]=n[s-1][i],n[s][i]=0}}e[s]=u}for(var s=0;s<r-1;s++){n[r-1][s]=n[s][s],n[s][s]=1;var u=e[s+1];if(u!=0){for(var a=0;a<=s;a++)e[a]=n[a][s+1]/u;for(var i=0;i<=s;i++){var l=0;for(var a=0;a<=s;a++)l+=n[a][s+1]*n[a][i];for(var a=0;a<=s;a++)n[a][i]-=l*e[a]}}for(var a=0;a<=s;a++)n[a][s+1]=0}for(var i=0;i<r;i++)e[i]=n[r-1][i],n[r-1][i]=0;n[r-1][r-1]=1,t[0]=0}function n(e,t,n){var r=n.length;for(var i=1;i<r;i++)t[i-1]=t[i];t[r-1]=0;var s=0,o=0,u=1e-12;for(var a=0;a<r;a++){o=Math.max(o,Math.abs(e[a])+Math.abs(t[a]));var f=a;while(f<r){if(Math.abs(t[f])<=u*o)break;f++}if(f>a){var l=0;do{l++;var c=e[a],h=(e[a+1]-c)/(2*t[a]),p=science.hypot(h,1);h<0&&(p=-p),e[a]=t[a]/(h+p),e[a+1]=t[a]*(h+p);var d=e[a+1],v=c-e[a];for(var i=a+2;i<r;i++)e[i]-=v;s+=v,h=e[f];var m=1,g=m,y=m,b=t[a+1],w=0,E=0;for(var i=f-1;i>=a;i--){y=g,g=m,E=w,c=m*t[i],v=m*h,p=science.hypot(h,t[i]),t[i+1]=w*p,w=t[i]/p,m=h/p,h=m*e[i]-w*c,e[i+1]=v+w*(m*c+w*e[i]);for(var S=0;S<r;S++)v=n[S][i+1],n[S][i+1]=w*n[S][i]+m*v,n[S][i]=m*n[S][i]-w*v}h=-w*E*y*b*t[a]/d,t[a]=w*h,e[a]=m*h}while(Math.abs(t[a])>u*o)}e[a]=e[a]+s,t[a]=0}for(var i=0;i<r-1;i++){var S=i,h=e[i];for(var x=i+1;x<r;x++)e[x]<h&&(S=x,h=e[x]);if(S!=i){e[S]=e[i],e[i]=h;for(var x=0;x<r;x++)h=n[x][i],n[x][i]=n[x][S],n[x][S]=h}}}function r(e,t){var n=e.length,r=[],i=0,s=n-1;for(var o=i+1;o<s;o++){var u=0;for(var a=o;a<=s;a++)u+=Math.abs(e[a][o-1]);if(u!==0){var f=0;for(var a=s;a>=o;a--)r[a]=e[a][o-1]/u,f+=r[a]*r[a];var l=Math.sqrt(f);r[o]>0&&(l=-l),f-=r[o]*l,r[o]=r[o]-l;for(var c=o;c<n;c++){var h=0;for(var a=s;a>=o;a--)h+=r[a]*e[a][c];h/=f;for(var a=o;a<=s;a++)e[a][c]-=h*r[a]}for(var a=0;a<=s;a++){var h=0;for(var c=s;c>=o;c--)h+=r[c]*e[a][c];h/=f;for(var c=o;c<=s;c++)e[a][c]-=h*r[c]}r[o]=u*r[o],e[o][o-1]=u*l}}for(var a=0;a<n;a++)for(var c=0;c<n;c++)t[a][c]=a===c?1:0;for(var o=s-1;o>=i+1;o--)if(e[o][o-1]!==0){for(var a=o+1;a<=s;a++)r[a]=e[a][o-1];for(var c=o;c<=s;c++){var l=0;for(var a=o;a<=s;a++)l+=r[a]*t[a][c];l=l/r[o]/e[o][o-1];for(var a=o;a<=s;a++)t[a][c]+=l*r[a]}}}function i(e,t,n,r){var i=n.length,o=i-1,u=0,a=i-1,f=1e-12,l=0,c=0,h=0,p=0,d=0,v=0,m,g,y,b,w=0;for(var E=0;E<i;E++){if(E<u||E>a)e[E]=n[E][E],t[E]=0;for(var S=Math.max(E-1,0);S<i;S++)w+=Math.abs(n[E][S])}var x=0;while(o>=u){var T=o;while(T>u){d=Math.abs(n[T-1][T-1])+Math.abs(n[T][T]),d===0&&(d=w);if(Math.abs(n[T][T-1])<f*d)break;T--}if(T===o)n[o][o]=n[o][o]+l,e[o]=n[o][o],t[o]=0,o--,x=0;else if(T===o-1){g=n[o][o-1]*n[o-1][o],c=(n[o-1][o-1]-n[o][o])/2,h=c*c+g,v=Math.sqrt(Math.abs(h)),n[o][o]=n[o][o]+l,n[o-1][o-1]=n[o-1][o-1]+l,y=n[o][o];if(h>=0){v=c+(c>=0?v:-v),e[o-1]=y+v,e[o]=e[o-1],v!==0&&(e[o]=y-g/v),t[o-1]=0,t[o]=0,y=n[o][o-1],d=Math.abs(y)+Math.abs(v),c=y/d,h=v/d,p=Math.sqrt(c*c+h*h),c/=p,h/=p;for(var S=o-1;S<i;S++)v=n[o-1][S],n[o-1][S]=h*v+c*n[o][S],n[o][S]=h*n[o][S]-c*v;for(var E=0;E<=o;E++)v=n[E][o-1],n[E][o-1]=h*v+c*n[E][o],n[E][o]=h*n[E][o]-c*v;for(var E=u;E<=a;E++)v=r[E][o-1],r[E][o-1]=h*v+c*r[E][o],r[E][o]=h*r[E][o]-c*v}else e[o-1]=y+c,e[o]=y+c,t[o-1]=v,t[o]=-v;o-=2,x=0}else{y=n[o][o],b=0,g=0,T<o&&(b=n[o-1][o-1],g=n[o][o-1]*n[o-1][o]);if(x==10){l+=y;for(var E=u;E<=o;E++)n[E][E]-=y;d=Math.abs(n[o][o-1])+Math.abs(n[o-1][o-2]),y=b=.75*d,g=-0.4375*d*d}if(x==30){d=(b-y)/2,d=d*d+g;if(d>0){d=Math.sqrt(d),b<y&&(d=-d),d=y-g/((b-y)/2+d);for(var E=u;E<=o;E++)n[E][E]-=d;l+=d,y=b=g=.964}}x++;var N=o-2;while(N>=T){v=n[N][N],p=y-v,d=b-v,c=(p*d-g)/n[N+1][N]+n[N][N+1],h=n[N+1][N+1]-v-p-d,p=n[N+2][N+1],d=Math.abs(c)+Math.abs(h)+Math.abs(p),c/=d,h/=d,p/=d;if(N==T)break;if(Math.abs(n[N][N-1])*(Math.abs(h)+Math.abs(p))<f*Math.abs(c)*(Math.abs(n[N-1][N-1])+Math.abs(v)+Math.abs(n[N+1][N+1])))break;N--}for(var E=N+2;E<=o;E++)n[E][E-2]=0,E>N+2&&(n[E][E-3]=0);for(var C=N;C<=o-1;C++){var k=C!=o-1;C!=N&&(c=n[C][C-1],h=n[C+1][C-1],p=k?n[C+2][C-1]:0,y=Math.abs(c)+Math.abs(h)+Math.abs(p),y!=0&&(c/=y,h/=y,p/=y));if(y==0)break;d=Math.sqrt(c*c+h*h+p*p),c<0&&(d=-d);if(d!=0){C!=N?n[C][C-1]=-d*y:T!=N&&(n[C][C-1]=-n[C][C-1]),c+=d,y=c/d,b=h/d,v=p/d,h/=c,p/=c;for(var S=C;S<i;S++)c=n[C][S]+h*n[C+1][S],k&&(c+=p*n[C+2][S],n[C+2][S]=n[C+2][S]-c*v),n[C][S]=n[C][S]-c*y,n[C+1][S]=n[C+1][S]-c*b;for(var E=0;E<=Math.min(o,C+3);E++)c=y*n[E][C]+b*n[E][C+1],k&&(c+=v*n[E][C+2],n[E][C+2]=n[E][C+2]-c*p),n[E][C]=n[E][C]-c,n[E][C+1]=n[E][C+1]-c*h;for(var E=u;E<=a;E++)c=y*r[E][C]+b*r[E][C+1],k&&(c+=v*r[E][C+2],r[E][C+2]=r[E][C+2]-c*p),r[E][C]=r[E][C]-c,r[E][C+1]=r[E][C+1]-c*h}}}}if(w==0)return;for(o=i-1;o>=0;o--){c=e[o],h=t[o];if(h==0){var T=o;n[o][o]=1;for(var E=o-1;E>=0;E--){g=n[E][E]-c,p=0;for(var S=T;S<=o;S++)p+=n[E][S]*n[S][o];if(t[E]<0)v=g,d=p;else{T=E,t[E]===0?n[E][o]=-p/(g!==0?g:f*w):(y=n[E][E+1],b=n[E+1][E],h=(e[E]-c)*(e[E]-c)+t[E]*t[E],m=(y*d-v*p)/h,n[E][o]=m,Math.abs(y)>Math.abs(v)?n[E+1][o]=(-p-g*m)/y:n[E+1][o]=(-d-b*m)/v),m=Math.abs(n[E][o]);if(f*m*m>1)for(var S=E;S<=o;S++)n[S][o]=n[S][o]/m}}}else if(h<0){var T=o-1;if(Math.abs(n[o][o-1])>Math.abs(n[o-1][o]))n[o-1][o-1]=h/n[o][o-1],n[o-1][o]=-(n[o][o]-c)/n[o][o-1];else{var L=s(0,-n[o-1][o],n[o-1][o-1]-c,h);n[o-1][o-1]=L[0],n[o-1][o]=L[1]}n[o][o-1]=0,n[o][o]=1;for(var E=o-2;E>=0;E--){var A=0,O=0,M,_;for(var S=T;S<=o;S++)A+=n[E][S]*n[S][o-1],O+=n[E][S]*n[S][o];g=n[E][E]-c;if(t[E]<0)v=g,p=A,d=O;else{T=E;if(t[E]==0){var L=s(-A,-O,g,h);n[E][o-1]=L[0],n[E][o]=L[1]}else{y=n[E][E+1],b=n[E+1][E],M=(e[E]-c)*(e[E]-c)+t[E]*t[E]-h*h,_=(e[E]-c)*2*h,M==0&_==0&&(M=f*w*(Math.abs(g)+Math.abs(h)+Math.abs(y)+Math.abs(b)+Math.abs(v)));var L=s(y*p-v*A+h*O,y*d-v*O-h*A,M,_);n[E][o-1]=L[0],n[E][o]=L[1];if(Math.abs(y)>Math.abs(v)+Math.abs(h))n[E+1][o-1]=(-A-g*n[E][o-1]+h*n[E][o])/y,n[E+1][o]=(-O-g*n[E][o]-h*n[E][o-1])/y;else{var L=s(-p-b*n[E][o-1],-d-b*n[E][o],v,h);n[E+1][o-1]=L[0],n[E+1][o]=L[1]}}m=Math.max(Math.abs(n[E][o-1]),Math.abs(n[E][o]));if(f*m*m>1)for(var S=E;S<=o;S++)n[S][o-1]=n[S][o-1]/m,n[S][o]=n[S][o]/m}}}}for(var E=0;E<i;E++)if(E<u||E>a)for(var S=E;S<i;S++)r[E][S]=n[E][S];for(var S=i-1;S>=u;S--)for(var E=u;E<=a;E++){v=0;for(var C=u;C<=Math.min(S,a);C++)v+=r[E][C]*n[C][S];r[E][S]=v}}function s(e,t,n,r){if(Math.abs(n)>Math.abs(r)){var i=r/n,s=n+i*r;return[(e+i*t)/s,(t-i*e)/s]}var i=n/r,s=r+i*n;return[(i*e+t)/s,(i*t-e)/s]}science.lin={},science.lin.decompose=function(){function e(e){var s=e.length,o=[],u=[],a=[];for(var f=0;f<s;f++)o[f]=[],u[f]=[],a[f]=[];var l=!0;for(var c=0;c<s;c++)for(var f=0;f<s;f++)if(e[f][c]!==e[c][f]){l=!1;break}if(l){for(var f=0;f<s;f++)o[f]=e[f].slice();t(u,a,o),n(u,a,o)}else{var h=[];for(var f=0;f<s;f++)h[f]=e[f].slice();r(h,o),i(u,a,h,o)}var p=[];for(var f=0;f<s;f++){var d=p[f]=[];for(var c=0;c<s;c++)d[c]=f===c?u[f]:0;p[f][a[f]>0?f+1:f-1]=a[f]}return{D:p,V:o}}return e},science.lin.cross=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},science.lin.dot=function(e,t){var n=0,r=-1,i=Math.min(e.length,t.length);while(++r<i)n+=e[r]*t[r];return n},science.lin.length=function(e){return Math.sqrt(science.lin.dot(e,e))},science.lin.normalize=function(e){var t=science.lin.length(e);return e.map(function(e){return e/t})},science.lin.determinant=function(e){var t=e[0].concat(e[1]).concat(e[2]).concat(e[3]);return t[12]*t[9]*t[6]*t[3]-t[8]*t[13]*t[6]*t[3]-t[12]*t[5]*t[10]*t[3]+t[4]*t[13]*t[10]*t[3]+t[8]*t[5]*t[14]*t[3]-t[4]*t[9]*t[14]*t[3]-t[12]*t[9]*t[2]*t[7]+t[8]*t[13]*t[2]*t[7]+t[12]*t[1]*t[10]*t[7]-t[0]*t[13]*t[10]*t[7]-t[8]*t[1]*t[14]*t[7]+t[0]*t[9]*t[14]*t[7]+t[12]*t[5]*t[2]*t[11]-t[4]*t[13]*t[2]*t[11]-t[12]*t[1]*t[6]*t[11]+t[0]*t[13]*t[6]*t[11]+t[4]*t[1]*t[14]*t[11]-t[0]*t[5]*t[14]*t[11]-t[8]*t[5]*t[2]*t[15]+t[4]*t[9]*t[2]*t[15]+t[8]*t[1]*t[6]*t[15]-t[0]*t[9]*t[6]*t[15]-t[4]*t[1]*t[10]*t[15]+t[0]*t[5]*t[10]*t[15]},science.lin.gaussjordan=function(e,t){t||(t=1e-10);var n=e.length,r=e[0].length,i=-1,s,o;while(++i<n){var u=i;s=i;while(++s<n)Math.abs(e[s][i])>Math.abs(e[u][i])&&(u=s);var a=e[i];e[i]=e[u],e[u]=a;if(Math.abs(e[i][i])<=t)return!1;s=i;while(++s<n){var f=e[s][i]/e[i][i];o=i-1;while(++o<r)e[s][o]-=e[i][o]*f}}i=n;while(--i>=0){var f=e[i][i];s=-1;while(++s<i){o=r;while(--o>=i)e[s][o]-=e[i][o]*e[s][i]/f}e[i][i]/=f,o=n-1;while(++o<r)e[i][o]/=f}return!0},science.lin.inverse=function(e){var t=e.length,n=-1;if(t!==e[0].length)return;e=e.map(function(e,n){var r=new Array(t),i=-1;while(++i<t)r[i]=n===i?1:0;return e.concat(r)}),science.lin.gaussjordan(e);while(++n<t)e[n]=e[n].slice(t);return e},science.lin.multiply=function(e,t){var n=e.length,r=t[0].length,i=t.length,s=-1,o,u;if(i!==e[0].length)throw{error:"columns(a) != rows(b); "+e[0].length+" != "+i};var a=new Array(n);while(++s<n){a[s]=new Array(r),o=-1;while(++o<r){var f=0;u=-1;while(++u<i)f+=e[s][u]*t[u][o];a[s][o]=f}}return a},science.lin.transpose=function(e){var t=e.length,n=e[0].length,r=-1,i,s=new Array(n);while(++r<n){s[r]=new Array(t),i=-1;while(++i<t)s[r][i]=e[i][r]}return s},science.lin.tridag=function(e,t,n,r,i,s){var o,u;for(o=1;o<s;o++)u=e[o]/t[o-1],t[o]-=u*n[o-1],r[o]-=u*r[o-1];i[s-1]=r[s-1]/t[s-1];for(o=s-2;o>=0;o--)i[o]=(r[o]-n[o]*i[o+1])/t[o]}}(this),function(e){function t(e,t){if(!e||!t||e.length!==t.length)return!1;var n=e.length,r=-1;while(++r<n)if(e[r]!==t[r])return!1;return!0}function n(e,n){var r=n.length;if(e>r)return null;var i=[],s=[],o={},u=0,a=0,f,l,c;while(a<e){if(u===r)return null;var h=Math.floor(Math.random()*r);if(h in o)continue;o[h]=1,u++,l=n[h],c=!0;for(f=0;f<a;f++)if(t(l,i[f])){c=!1;break}c&&(i[a]=l,s[a]=h,a++)}return i}function r(e,t,n,r){var i=[],s=e+n,o=t.length,u=-1;while(++u<o)i[u]=(e*t[u]+n*r[u])/s;return i}function i(e){var t=e.length,n=-1;while(++n<t)if(!isFinite(e[n]))return!1;return!0}function s(e){var t=e.length,n=0;while(++n<t)if(e[n-1]>=e[n])return!1;return!0}function o(e){return(e=1-e*e*e)*e*e}function u(e,t,n,r){var i=r[0],s=r[1],o=a(t,s);if(o<e.length&&e[o]-e[n]<e[n]-e[i]){var u=a(t,i);r[0]=u,r[1]=o}}function a(e,t){var n=t+1;while(n<e.length&&e[n]===0)n++;return n}science.stats={},science.stats.bandwidth={nrd0:function(e){var t=Math.sqrt(science.stats.variance(e));return(lo=Math.min(t,science.stats.iqr(e)/1.34))||(lo=t)||(lo=Math.abs(e[1]))||(lo=1),.9*lo*Math.pow(e.length,-0.2)},nrd:function(e){var t=science.stats.iqr(e)/1.34;return 1.06*Math.min(Math.sqrt(science.stats.variance(e)),t)*Math.pow(e.length,-0.2)}},science.stats.distance={euclidean:function(e,t){var n=e.length,r=-1,i=0,s;while(++r<n)s=e[r]-t[r],i+=s*s;return Math.sqrt(i)},manhattan:function(e,t){var n=e.length,r=-1,i=0;while(++r<n)i+=Math.abs(e[r]-t[r]);return i},minkowski:function(e){return function(t,n){var r=t.length,i=-1,s=0;while(++i<r)s+=Math.pow(Math.abs(t[i]-n[i]),e);return Math.pow(s,1/e)}},chebyshev:function(e,t){var n=e.length,r=-1,i=0,s;while(++r<n)s=Math.abs(e[r]-t[r]),s>i&&(i=s);return i},hamming:function(e,t){var n=e.length,r=-1,i=0;while(++r<n)e[r]!==t[r]&&i++;return i},jaccard:function(e,t){var n=e.length,r=-1,i=0;while(++r<n)e[r]===t[r]&&i++;return i/n},braycurtis:function(e,t){var n=e.length,r=-1,i=0,s=0,o,u;while(++r<n)o=e[r],u=t[r],i+=Math.abs(o-u),s+=Math.abs(o+u);return i/s}},science.stats.erf=function(e){var t=.254829592,n=-0.284496736,r=1.421413741,i=-1.453152027,s=1.061405429,o=.3275911,u=e<0?-1:1;e<0&&(u=-1,e=-e);var a=1/(1+o*e);return u*(1-((((s*a+i)*a+r)*a+n)*a+t)*a*Math.exp(-e*e))},science.stats.phi=function(e){return.5*(1+science.stats.erf(e/Math.SQRT2))},science.stats.kernel={uniform:function(e){return e<=1&&e>=-1?.5:0},triangular:function(e){return e<=1&&e>=-1?1-Math.abs(e):0},epanechnikov:function(e){return e<=1&&e>=-1?.75*(1-e*e):0},quartic:function(e){if(e<=1&&e>=-1){var t=1-e*e;return.9375*t*t}return 0},triweight:function(e){if(e<=1&&e>=-1){var t=1-e*e;return 35/32*t*t*t}return 0},gaussian:function(e){return 1/Math.sqrt(2*Math.PI)*Math.exp(-0.5*e*e)},cosine:function(e){return e<=1&&e>=-1?Math.PI/4*Math.cos(Math.PI/2*e):0}},science.stats.kde=function(){function r(r,i){var s=n.call(this,t);return r.map(function(n){var r=-1,i=0,o=t.length;while(++r<o)i+=e((n-t[r])/s);return[n,i/s/o]})}var e=science.stats.kernel.gaussian,t=[],n=science.stats.bandwidth.nrd;return r.kernel=function(t){return arguments.length?(e=t,r):e},r.sample=function(e){return arguments.length?(t=e,r):t},r.bandwidth=function(e){return arguments.length?(n=science.functor(e),r):n},r},science.stats.kmeans=function(){function s(s){var o=s.length,u=[],a=[],f=1,l=0,c=n(i,s),h,p,d,v,m,g,y;while(f&&l<r){d=-1;while(++d<i)a[d]=0;p=-1;while(++p<o){v=s[p],g=Infinity,d=-1;while(++d<i)m=e.call(this,c[d],v),m<g&&(g=m,y=d);a[u[p]=y]++}h=[],p=-1;while(++p<o){v=u[p],m=h[v];if(m==null)h[v]=s[p].slice();else{d=-1;while(++d<m.length)m[d]+=s[p][d]}}d=-1;while(++d<i){v=h[d],m=1/a[d],p=-1;while(++p<v.length)v[p]*=m}f=0,d=-1;while(++d<i)if(!t(h[d],c[d])){f=1;break}c=h,l++}return{assignments:u,centroids:c}}var e=science.stats.distance.euclidean,r=1e3,i=1;return s.k=function(e){return arguments.length?(i=e,s):i},s.distance=function(t){return arguments.length?(e=t,s):e},s},science.stats.hcluster=function(){function n(n){var i=n.length,s=[],o=[],u=[],a=[],f,l,c,h,p,d,v,m;v=-1;while(++v<i){s[v]=0,u[v]=[],m=-1;while(++m<i)u[v][m]=v===m?Infinity:e(n[v],n[m]),u[v][s[v]]>u[v][m]&&(s[v]=m)}v=-1;while(++v<i)a[v]=[],a[v][0]={left:null,right:null,dist:0,centroid:n[v],size:1,depth:0},o[v]=1;for(p=0;p<i-1;p++){f=0;for(v=0;v<i;v++)u[v][s[v]]<u[f][s[f]]&&(f=v);l=s[f],c=a[f][0],h=a[l][0];var g={left:c,right:h,dist:u[f][l],centroid:r(c.size,c.centroid,h.size,h.centroid),size:c.size+h.size,depth:1+Math.max(c.depth,h.depth)};a[f].splice(0,0,g),o[f]+=o[l];for(m=0;m<i;m++)switch(t){case"single":u[f][m]>u[l][m]&&(u[m][f]=u[f][m]=u[l][m]);break;case"complete":u[f][m]<u[l][m]&&(u[m][f]=u[f][m]=u[l][m]);break;case"average":u[m][f]=u[f][m]=(o[f]*u[f][m]+o[l]*u[l][m])/(o[f]+o[m])}u[f][f]=Infinity;for(v=0;v<i;v++)u[v][l]=u[l][v]=Infinity;for(m=0;m<i;m++)s[m]==l&&(s[m]=f),u[f][m]<u[f][s[f]]&&(s[f]=m);d=g}return d}var e=science.stats.distance.euclidean,t="simple";return n.distance=function(t){return arguments.length?(e=t,n):e},n},science.stats.iqr=function(e){var t=science.stats.quantiles(e,[.25,.75]);return t[1]-t[0]},science.stats.loess=function(){function r(r,a,f){var l=r.length,c;if(l!==a.length)throw{error:"Mismatched array lengths"};if(l==0)throw{error:"At least one point required."};if(arguments.length<3){f=[],c=-1;while(++c<l)f[c]=1}i(r),i(a),i(f),s(r);if(l==1)return[a[0]];if(l==2)return[a[0],a[1]];var h=Math.floor(e*l);if(h<2)throw{error:"Bandwidth too small."};var p=[],d=[],v=[];c=-1;while(++c<l)p[c]=0,d[c]=0,v[c]=1;var m=-1;while(++m<=t){var g=[0,h-1],y;c=-1;while(++c<l){y=r[c],c>0&&u(r,f,c,g);var b=g[0],w=g[1],E=r[c]-r[b]>r[w]-r[c]?b:w,S=0,x=0,T=0,N=0,C=0,k=Math.abs(1/(r[E]-y));for(var L=b;L<=w;++L){var A=r[L],O=a[L],M=L<c?y-A:A-y,_=o(M*k)*v[L]*f[L],D=A*_;S+=_,x+=D,T+=A*D,N+=O*_,C+=O*D}var P=x/S,H=N/S,B=C/S,j=T/S,F=Math.sqrt(Math.abs(j-P*P))<n?0:(B-P*H)/(j-P*P),I=H-F*P;p[c]=F*y+I,d[c]=Math.abs(a[c]-p[c])}if(m===t)break;var q=d.slice();q.sort();var R=q[Math.floor(l/2)];if(Math.abs(R)<n)break;var U,_;c=-1;while(++c<l)U=d[c]/(6*R),v[c]=U>=1?0:(_=1-U*U)*_}return p}var e=.3,t=2,n=1e-12;return r.bandwidth=function(t){return arguments.length?(e=t,r):t},r.robustnessIterations=function(e){return arguments.length?(t=e,r):e},r.accuracy=function(e){return arguments.length?(n=e,r):e},r},science.stats.mean=function(e){var t=e.length;if(t===0)return NaN;var n=0,r=-1;while(++r<t)n+=(e[r]-n)/(r+1);return n},science.stats.median=function(e){return science.stats.quantiles(e,[.5])[0]},science.stats.mode=function(e){var t={},n=[],r=0,i=e.length,s=-1,o,u;while(++s<i)u=t.hasOwnProperty(o=e[s])?++t[o]:t[o]=1,u===r?n.push(o):u>r&&(r=u,n=[o]);if(n.length===1)return n[0]},science.stats.quantiles=function(e,t){e=e.slice().sort(science.ascending);var n=e.length-1;return t.map(function(t){if(t===0)return e[0];if(t===1)return e[n];var r=1+t*n,i=Math.floor(r),s=r-i,o=e[i-1];return s===0?o:o+s*(e[i]-o)})},science.stats.variance=function(e){var t=e.length;if(t<1)return NaN;if(t===1)return 0;var n=science.stats.mean(e),r=-1,i=0;while(++r<t){var s=e[r]-n;i+=s*s}return i/(t-1)},science.stats.distribution={},science.stats.distribution.gaussian=function(){function i(){var r,i,s,o;do r=2*e()-1,i=2*e()-1,s=r*r+i*i;while(s>=1||s===0);return t+n*r*Math.sqrt(-2*Math.log(s)/s)}var e=Math.random,t=0,n=1,r=1;return i.pdf=function(e){return e=(e-t)/n,science_stats_distribution_gaussianConstant*Math.exp(-0.5*e*e)/n},i.cdf=function(e){return e=(e-t)/n,.5*(1+science.stats.erf(e/Math.SQRT2))},i.mean=function(e){return arguments.length?(t=+e,i):t},i.variance=function(e){return arguments.length?(n=Math.sqrt(r=+e),i):r},i.random=function(t){return arguments.length?(e=t,i):e},i},science_stats_distribution_gaussianConstant=1/Math.sqrt(2*Math.PI)}(this)})(this);