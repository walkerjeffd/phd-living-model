define(["jquery","underscore","backbone","d3","app/charts","app/sim","app/views/info","app/views/parameters","app/views/brush","app/views/timeseries","app/views/scatter","app/views/summary"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=n.View.extend({template:t.template(e("#template-model").html()),initialize:function(){console.log("ModelView: initialize"),this.render(),window.APP=this,this.model.fetch({success:function(e,t,n){e.trigger("fetchInput")},error:function(e,t,n){console.log("ERROR:",t)}}),this.simModel=new s,this.extent=null,this.listenTo(this.model,"updateInput",this.updateInput),this.listenTo(this.model,"changeParam",this.recompute),this.listenTo(this.model,"setExtent",this.setExtent),this.listenTo(this.model,"fetchInput",this.fetchInput),this.infoView=new o({model:this.model,simModel:this.simModel,el:this.$("#model-info")}),this.paramsView=new u({model:this.model,el:this.$("#params")}),this.brushView=new a({model:this.model,simModel:this.simModel,el:this.$("#chart-brush")}),this.tsView=new f({model:this.model,simModel:this.simModel,el:this.$("#chart-ts")}),this.scatterView=new l({model:this.model,simModel:this.simModel,el:this.$("#chart-scatter")}),this.summaryView=new c({model:this.model,simModel:this.simModel,el:this.$("#summary")})},fetchInput:function(){var e=r.time.format("%Y-%m-%d");r.csv(this.model.getInputURL()).row(function(t){return{Date:e.parse(t.Date),Precip_in:+t.Precip_in,Tmin_degC:+t.Tmin_degC,Tmax_degC:+t.Tmax_degC,Flow_in:+t.Flow_in}}).get(function(e,t){this.$("#loading-row").hide(),this.$(".model-row").show(),this.model.input=t,this.model.trigger("updateInput")}.bind(this))},recompute:function(){this.simModel.run(this.model),this.model.trigger("recompute"),this.brushView.render(),this.tsView.render(),this.scatterView.render()},setExtent:function(e){var t=r.time.format("%Y-%m-%d");e&&(e=e.map(t)),this.model.extent=e},updateInput:function(){this.simModel.setInput(this.model.input,this.model.get("watershed").latitude),this.recompute()},render:function(){console.log("ModelView: render"),this.$el.html(this.template())}});return h});