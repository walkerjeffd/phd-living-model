define(["jquery","underscore","d3"],function(e,t,n){var r=function(e){var t=e.length;if(t===0)return NaN;var n=0,r=-1;while(++r<t)n+=e[r];return n},i=function(e){var t=e.length;if(t===0)return NaN;var n=0,r=-1;while(++r<t)n+=(e[r]-n)/(r+1);return n},s=function(e){var t=e.length;if(t<1)return NaN;if(t===1)return 0;var n=i(e),r=-1,s=0;while(++r<t){var o=e[r]-n;s+=o*o}return s/t},o=function(e,n,r){var o=function(e){return Math.log(e)*Math.LOG10E},u=e.map(function(e){return Math.pow(o(e[n])-o(e[r]),2)}),a=t.pluck(e,n).map(function(e){return o(e)}),f=i(u),l=i(t.pluck(e,n).map(o)),c=i(t.pluck(e,r).map(o)),h=(l-c)/l;return{rmse:Math.sqrt(f),nse:1-f/s(a),perBias:h}},u=function(e,t){t=t===undefined?!0:t;var n="",r="",i;if(t){r="";for(i in e[0])r!==""&&(r+=","),r+=i;n+=r+"\r\n"}for(var s=0;s<e.length;s++){r="";for(i in e[s])r!==""&&(r+=","),r+=e[s][i];n+=r+"\r\n"}return n},a=function(e,t){var n=u(e,!0);l(n,t,"text/csv")},f=function(e,t){var n=JSON.stringify(e);l(n,t,"application/json")},l=function(t,n,r){r=r||"text/plain";var i=new Blob([t],{type:"text/plain"});if(window.navigator.msSaveBlob)window.navigator.msSaveBlob(i,n);else{var s=e("<a></a>").attr("href",window.URL.createObjectURL(i)).attr("download",n);e("body").append(s),s[0].click()}};return{sum:r,mean:i,variance:s,statsGOF:o,saveToFile:l,saveToCSVFile:a,saveToJSONFile:f}});